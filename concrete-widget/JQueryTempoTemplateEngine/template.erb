<ol id="<%= @id %>">
  <dd data-template style="display: none;">
    <%= @content %>
  </dd>
  <dd class="error" data-template-fallback>
      <%= @msg_error %>
  </dd>
</ol>
<script type="text/javascript" charset="utf-8">
  var load_<%= @id %>;
  $(document).ready(function() {
    
    var tpl_<%= @id %> = Tempo.prepare('<%= @id %>').notify(function(event) {
        if (event.type === TempoEvent.Types.RENDER_STARTING || event.type === TempoEvent.Types.RENDER_COMPLETE) {
					$('ol#<%= @id %>').toggleClass('loading');
				}
			});
   
    load_<%= @id %> = function(){
      tpl_<%= @id %>.starting();
      var url_<%= @id %>;
      <% unless(@params[:url_from_element_id]).nil? %>
        var url_<%= @id %> = $("#<%= @params[:url_from_element_id] %>").val();
      <% end %>
      $.ajax({
        url: url_<%= @id %> ? url_<%= @id %> : "<%= @json_source_url %>",
        dataType: "json",
        timeout: 7000,
        success: function(data) {
          tpl_<%= @id %>.render(data<%=@node_json_result_element%>);
        },
        error: function(data){$('ol#tweets').toggleClass('loading');$('ol#tweets .error').show();}
      });
    }
    load_<%= @id %>();
  });
</script>